아이템 4.컨테이너로 이미지 만들기
=========================
## ⭕ 컨테이너로 이미지 만드는 방법
### ◉ commit 커맨드로 컨테이너를 이미지로 변환
컨테이너를 준비하고 컨테이너를 이미지로 변환한다.
> docker commit [옵션] 컨테이너이름 [이미지이름]

### ◉ Dockerfile 스크립트로 이미지 만들기
Dockerfile 스크립트를 작성하고 이 스크립트를 빌드해 이미지를 만드는 방법이다. Dockerfile 스크립트에는 토대가 될 이미지나 실행할 명령어 등을 기재한다.
> docker build [옵션] [Dockerfile 경로]

* 주요 Dockerfile 명령어

| 명령어 | 설명                                       |
|------|------------------------------------------|
| FROM | 베이스 이미지를 지정                              |
| ADD | 이미지에 파일이나 폴더를 추가                         |
| COPY | 이미지에 파일이나 폴더를 복사                         |
| RUN | 이미지를 빌드할 때 실행할 명령어를 지정                   |
| CMD | 컨테이너가 시작될 때 실행할 명령어를 지정                  |
| ENTRYPOINT | 컨테이너가 시작될 때 실행할 명령어를 강제 지정               |
| ONBUILD | 이 이미지를 기반으로 다른 이미지를 빌드할 때 실행할 명령어를 지정    |
| EXPOSE | 이미지가 통신에 사용할 포트를 지정                      |
| VOLUME | 볼륨을 지정                                   |
| ENV | 환경 변수를 정의                                |
| WORKDIR | 정의된 명령어를 실행하는 작업 디렉터리를 지정                |
| SHELL | 빌드 시 사용할 셀을 변경                           
| LABEL | 이름이나 버전, 저작자 정보 등의 메타데이터를 추가             |
| USER | 정의된 명령어를 실행하는 사용자 또는 그룹을 지정              |
| ARG | docker build 커맨드를 사용할 때 입력받을 수 있는 인자를 선언 |
| STOPSIGNAL | 컨테이너가 종료될 때 사용할 시그널을 지정                  |
| HEALTHCHECK | 컨테이너의 헬스체크 방법을 커스터마이징                    |

---

## ⭕ commit 커맨드로 컨테이너를 이미지로 변환
### ◉ 실습 내용
아파치 컨테이너 생성 및 실행 -> 컨테이너를 이미지로 변환 -> 확인

### ◉ 생성할 이미지 정보 및 커맨드
| 항목 | 값          |
|----|------------|
| 컨테이너 이름 | apa000ex22 |
| 새로 만들 이미지 이름 | ex22_original1 |

1. 아파치 컨테이너 준비
> docker run --name apa000ex22 -d -p 8092:80 httpd
2. 컨테이너를 변환한 새로운 이미지 생성
> docker commit apa000ex22 ex22_original1
3. 이미지 확인
> docker images

---

## ⭕ Dockerfile 스크립트로 이미지 만들기
### ◉ 실습 내용
Dockerfile 스크립트 작성 -> 이미지 빌드 -> 확인

### 새로 만들 이미지 정보 및 명령어
| 항목        | 값     |
|-----------|-------|
| 기반 이미지 이름 | httpd |
| 새로 만들 이미지 이름 | ex22_original2 |

1. 재료 폴더에 재료 준비
2. Dockerfile 스크립트 작성
3. build 커맨드로 이미지 빌드
> docker build -t ex22_original2 /Users/hhnho/workspace/docker-kubernetes/src/main/resources/example/image/docker-file
4. 이미지 확인
5. 생성된 이미지로 컨테이너 생성 및 실행
> docker run --name apa000ex23 -d -p 8093:80 ex22_original2
6. 웹 브라우저를 통해 아파치에 접근해 초기 화면 확인
7. 뒷정리

#### ✦ 이미지를 옮기는 방법
이미지 상태 그대로는 옮기거나 복사할 수 없다. save 커맨드를 사용해 tar 포맷으로 도커 엔진의 관리 영역 밖으로 내보내야 한다. 다시 도커 엔진에 가져오려면 load 커맨드를 사용한다.
> docker save -o [저장할 파일명] [이미지 이름]
> docker load -i [불러올 파일명]

